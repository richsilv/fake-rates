(function () {

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                  //
// packages/fake-rates/prices.js                                                                                    //
//                                                                                                                  //
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                    //
seedPrices = {                                                                                                      // 1
	"USDKRW": 1122.449951,                                                                                             // 2
	"USDVND": 20865.000000,                                                                                            // 3
	"USDBOB": 6.910000,                                                                                                // 4
	"USDMOP": 7.995750,                                                                                                // 5
	"USDBDT": 78.070000,                                                                                               // 6
	"USDMDL": 12.280000,                                                                                               // 7
	"USDVEF": 6.287700,                                                                                                // 8
	"USDGEL": 1.657000,                                                                                                // 9
	"USDISK": 117.410004,                                                                                              // 10
	"USDBYR": 8670.000000,                                                                                             // 11
	"USDTHB": 28.844999,                                                                                               // 12
	"USDTND": 1.603500,                                                                                                // 13
	"USDJMD": 99.099998,                                                                                               // 14
	"USDDKK": 5.718700,                                                                                                // 15
	"USDSRD": 3.275000,                                                                                                // 16
	"USDBWP": 8.188300,                                                                                                // 17
	"USDNOK": 5.799550,                                                                                                // 18
	"USDMUR": 31.129999,                                                                                               // 19
	"USDZMK": 5195.000000,                                                                                             // 20
	"USDAZN": 0.784700,                                                                                                // 21
	"USDINR": 54.210499,                                                                                               // 22
	"USDMGA": 2160.000000,                                                                                             // 23
	"USDCAD": 1.027095,                                                                                                // 24
	"USDXAF": 502.649048,                                                                                              // 25
	"USDLBP": 1504.000000,                                                                                             // 26
	"USDXDR": 0.664350,                                                                                                // 27
	"USDIDR": 9710.000000,                                                                                             // 28
	"USDIEP": 0.603482,                                                                                                // 29
	"USDAUD": 0.972200,                                                                                                // 30
	"USDMMK": 880.500000,                                                                                              // 31
	"USDLYD": 1.281000,                                                                                                // 32
	"USDZAR": 9.190750,                                                                                                // 33
	"USDIQD": 1163.000000,                                                                                             // 34
	"USDXPF": 91.400002,                                                                                               // 35
	"USDTJS": 4.761600,                                                                                                // 36
	"USDCUP": 1.000000,                                                                                                // 37
	"USDUGX": 2557.500000,                                                                                             // 38
	"USDNGN": 158.399994,                                                                                              // 39
	"USDPGK": 2.184200,                                                                                                // 40
	"USDTOP": 1.741686,                                                                                                // 41
	"USDTMT": 2.850000,                                                                                                // 42
	"USDKES": 83.900002,                                                                                               // 43
	"USDCRC": 499.399994,                                                                                              // 44
	"USDMZN": 30.330000,                                                                                               // 45
	"USDSYP": 70.230003,                                                                                               // 46
	"USDANG": 1.790000,                                                                                                // 47
	"USDZMW": 5.335000,                                                                                                // 48
	"USDBRL": 2.001150,                                                                                                // 49
	"USDBSD": 1.000000,                                                                                                // 50
	"USDNIO": 24.965000,                                                                                               // 51
	"USDGNF": 7062.000000,                                                                                             // 52
	"USDBMD": 1.000000,                                                                                                // 53
	"USDSLL": 4313.799805,                                                                                             // 54
	"USDMKD": 47.029999,                                                                                               // 55
	"USDBIF": 1560.000000,                                                                                             // 56
	"USDLAK": 7825.500000,                                                                                             // 57
	"USDBHD": 0.376960,                                                                                                // 58
	"USDSHP": 0.656350,                                                                                                // 59
	"USDBGN": 1.494700,                                                                                                // 60
	"USDSGD": 1.236840,                                                                                                // 61
	"USDCNY": 6.176800,                                                                                                // 62
	"USDEUR": 0.767065,                                                                                                // 63
	"USDTTD": 6.420000,                                                                                                // 64
	"USDSCR": 11.770000,                                                                                               // 65
	"USDBBD": 2.000000,                                                                                                // 66
	"USDSBD": 7.209613,                                                                                                // 67
	"USDMAD": 8.528000,                                                                                                // 68
	"USDGTQ": 7.792500,                                                                                                // 69
	"USDMWK": 415.600006,                                                                                              // 70
	"USDPKR": 98.410004,                                                                                               // 71
	"USDPEN": 2.593000,                                                                                                // 72
	"USDAED": 3.672750,                                                                                                // 73
	"USDLVL": 0.537300,                                                                                                // 74
	"USDUAH": 8.136000,                                                                                                // 75
	"USDLRD": 74.000000,                                                                                               // 76
	"USDLSL": 9.190000,                                                                                                // 77
	"USDSEK": 6.502500,                                                                                                // 78
	"USDRON": 3.350200,                                                                                                // 79
	"USDXOF": 503.200012,                                                                                              // 80
	"USDCOP": 1849.000000,                                                                                             // 81
	"USDCDF": 919.411316,                                                                                              // 82
	"USDTZS": 1626.500000,                                                                                             // 83
	"USDGHS": 1.949300,                                                                                                // 84
	"USDNPR": 86.349998,                                                                                               // 85
	"USDZWL": 322.355011,                                                                                              // 86
	"USDSOS": 1550.000000,                                                                                             // 87
	"USDDZD": 78.543999,                                                                                               // 88
	"USDFKP": 0.656300,                                                                                                // 89
	"USDLKR": 125.550003,                                                                                              // 90
	"USDJPY": 97.355003,                                                                                               // 91
	"USDCHF": 0.931370,                                                                                                // 92
	"USDCLP": 474.450012,                                                                                              // 93
	"USDIRR": 12285.000000,                                                                                            // 94
	"USDAFN": 52.970001,                                                                                               // 95
	"USDDJF": 179.699997,                                                                                              // 96
	"USDSVC": 8.747500,                                                                                                // 97
	"USDPLN": 3.158050,                                                                                                // 98
	"USDPYG": 4130.000000,                                                                                             // 99
	"USDETB": 18.551901,                                                                                               // 100
	"USDILS": 3.632000,                                                                                                // 101
	"USDTWD": 29.931999,                                                                                               // 102
	"USDKPW": 900.000000,                                                                                              // 103
	"USDGIP": 0.656350,                                                                                                // 104
	"USDBND": 1.235550,                                                                                                // 105
	"USDHNL": 19.370001,                                                                                               // 106
	"USDCZK": 19.832500,                                                                                               // 107
	"USDHUF": 226.449997,                                                                                              // 108
	"USDBZD": 2.020000,                                                                                                // 109
	"USDJOD": 0.708150,                                                                                                // 110
	"USDRWF": 636.000000,                                                                                              // 111
	"USDLTL": 2.649000,                                                                                                // 112
	"USDRUB": 31.840000,                                                                                               // 113
	"USDRSD": 85.410500,                                                                                               // 114
	"USDWST": 2.224969,                                                                                                // 115
	"USDPAB": 1.000000,                                                                                                // 116
	"USDNAD": 9.185000,                                                                                                // 117
	"USDDOP": 41.125000,                                                                                               // 118
	"USDALL": 107.574997,                                                                                              // 119
	"USDHTG": 42.500000,                                                                                               // 120
	"USDAMD": 418.299988,                                                                                              // 121
	"USDKMF": 376.986786,                                                                                              // 122
	"USDMRO": 270.250000,                                                                                              // 123
	"USDHRK": 5.839250,                                                                                                // 124
	"USDKHR": 3985.000000,                                                                                             // 125
	"USDPHP": 41.250000,                                                                                               // 126
	"USDKWD": 0.284750,                                                                                                // 127
	"USDXCD": 2.700000,                                                                                                // 128
	"USDCNH": 6.182800,                                                                                                // 129
	"USDSDG": 4.402500,                                                                                                // 130
	"USDCLF": 0.020730,                                                                                                // 131
	"USDKZT": 150.994995,                                                                                              // 132
	"USDTRY": 1.798550,                                                                                                // 133
	"USDFJD": 1.765200,                                                                                                // 134
	"USDNZD": 1.184329,                                                                                                // 135
	"USDBAM": 1.504050,                                                                                                // 136
	"USDBTN": 54.160000,                                                                                               // 137
	"USDSTD": 18675.000000,                                                                                            // 138
	"USDVUV": 91.400002,                                                                                               // 139
	"USDMVR": 15.420000,                                                                                               // 140
	"USDAOA": 96.010498,                                                                                               // 141
	"USDEGP": 6.897150,                                                                                                // 142
	"USDQAR": 3.640800,                                                                                                // 143
	"USDOMR": 0.384950,                                                                                                // 144
	"USDCVE": 84.139999,                                                                                               // 145
	"USDKGS": 48.277199,                                                                                               // 146
	"USDMXN": 12.249550,                                                                                               // 147
	"USDMYR": 3.030500,                                                                                                // 148
	"USDGYD": 203.600006,                                                                                              // 149
	"USDSZL": 9.193000,                                                                                                // 150
	"USDYER": 214.455002,                                                                                              // 151
	"USDSAR": 3.750300,                                                                                                // 152
	"USDUYU": 18.830000,                                                                                               // 153
	"USDGBP": 0.655766,                                                                                                // 154
	"USDUZS": 2054.300049,                                                                                             // 155
	"USDGMD": 34.000000,                                                                                               // 156
	"USDAWG": 1.789700,                                                                                                // 157
	"USDMNT": 1407.500000,                                                                                             // 158
	"USDHKD": 7.762935,                                                                                                // 159
	"USDARS": 5.156000                                                                                                 // 160
};                                                                                                                  // 161
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}).call(this);






(function () {

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                  //
// packages/fake-rates/fakerates.js                                                                                 //
//                                                                                                                  //
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                    //
var events = Npm.require('events');                                                                                 // 1
                                                                                                                    // 2
FakeRates = function(currencyPair, options) {                                                                       // 3
                                                                                                                    // 4
	var _this = this,                                                                                                  // 5
		altPair = currencyPair.slice(3) + currencyPair.slice(0,3),                                                        // 6
		currentTimeout,                                                                                                   // 7
		seedPrice;                                                                                                        // 8
                                                                                                                    // 9
	if (seedPrices[currencyPair]) {                                                                                    // 10
		seedPrice = seedPrices[currencyPair];                                                                             // 11
	}                                                                                                                  // 12
	else if (seedPrices[altPair]) {                                                                                    // 13
		seedPrice = 1 / seedPrices[altPair];                                                                              // 14
	}                                                                                                                  // 15
	else {                                                                                                             // 16
		return new Meteor.Error(500, "Cannot find currency pair", {currencyPair: currencyPair});                          // 17
	}                                                                                                                  // 18
                                                                                                                    // 19
	options = options || {};                                                                                           // 20
	this._id = Random.id();                                                                                            // 21
	this.currencyPair = currencyPair;                                                                                  // 22
	this.price = options.seedPrice || seedPrice;                                                                       // 23
	this.spread = options.spread || seedPrice / 1000;                                                                  // 24
	this.delay = options.delay || 1;                                                                                   // 25
	this.stdDev = options.stdDev || 1;                                                                                 // 26
	this.emitter = new events.EventEmitter();                                                                          // 27
                                                                                                                    // 28
	function stdNorm() {                                                                                               // 29
                                                                                                                    // 30
		return ((Math.random() + Math.random() + Math.random() + Math.random() + Math.random() + Math.random()) - 3) / 3; // 31
	                                                                                                                   // 32
	}                                                                                                                  // 33
                                                                                                                    // 34
	function poisson(expectedValue){                                                                                   // 35
	                                                                                                                   // 36
	    return - Math.log( Math.random() ) * expectedValue;                                                            // 37
                                                                                                                    // 38
	}                                                                                                                  // 39
                                                                                                                    // 40
	function nextEmission() {                                                                                          // 41
	                                                                                                                   // 42
		var price = _this.price * (1 + stdNorm() * _this.stdDev / 100);                                                   // 43
		var bid = price - _this.spread / 2;                                                                               // 44
		var offer = price + _this.spread / 2;                                                                             // 45
                                                                                                                    // 46
 		price = Math.floor(price * 1000000) / 1000000;                                                                   // 47
		bid =  Math.floor(bid * 1000000) / 1000000;                                                                       // 48
		offer = Math.floor(offer * 1000000) / 1000000;                                                                    // 49
		                                                                                                                  // 50
		var event = {                                                                                                     // 51
			'ticker' : _this.currencyPair,                                                                                   // 52
			'bid':bid,                                                                                                       // 53
			'mid':price,                                                                                                     // 54
			'offer':offer,                                                                                                   // 55
			'time':new Date(),                                                                                               // 56
			'emitter':_this._id                                                                                              // 57
		}                                                                                                                 // 58
                                                                                                                    // 59
		_this.price = price;                                                                                              // 60
                                                                                                                    // 61
		_this.emitter.emit('price', event);		                                                                             // 62
                                                                                                                    // 63
		var nextDelay = poisson(_this.delay * 1000);                                                                      // 64
                                                                                                                    // 65
		currentTimeout = Meteor.setTimeout(nextEmission, nextDelay);                                                      // 66
                                                                                                                    // 67
	}                                                                                                                  // 68
                                                                                                                    // 69
	this.stop = function() {                                                                                           // 70
                                                                                                                    // 71
		if (currentTimeout) {                                                                                             // 72
			Meteor.clearTimeout(currentTimeout);                                                                             // 73
			currentTimeout = null;                                                                                           // 74
			return 1;                                                                                                        // 75
		}                                                                                                                 // 76
		else                                                                                                              // 77
			return 0;                                                                                                        // 78
                                                                                                                    // 79
	};                                                                                                                 // 80
                                                                                                                    // 81
	var nextDelay = poisson(_this.delay);                                                                              // 82
                                                                                                                    // 83
	currentTimeout = Meteor.setTimeout(nextEmission, nextDelay);                                                       // 84
                                                                                                                    // 85
};                                                                                                                  // 86
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}).call(this);
